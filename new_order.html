<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ | Arab Eagles</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="css/style.css">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
</head>
<body>

    <div id="app-header"></div>

    <div class="container">
        
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #222; padding-bottom:15px;">
            <h2 style="color:#d4af37; margin:0; font-size:1.3rem;">ÙØªØ­ ØªØ°ÙƒØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <a href="dashboard.html" style="background:rgba(255,255,255,0.05); color:#ccc; padding:8px 15px; border-radius:20px; font-size:0.85rem; text-decoration:none; border:1px solid #333;">
                <i class="fa-solid fa-arrow-right"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
        </div>
        
        <div class="type-selector" style="display:flex; gap:10px; margin-bottom:25px;">
            <div class="type-btn active" onclick="setMode('order')" id="btnOrder" style="flex:1; padding:15px; background:#1a1a1a; border:1px solid #333; color:#888; border-radius:12px; cursor:pointer; text-align:center; transition:0.3s;">
                <i class="fa-solid fa-industry" style="display:block; font-size:1.4rem; margin-bottom:5px;"></i>
                <span>Ø£Ù…Ø± ØªØ´ØºÙŠÙ„</span>
            </div>
            <div class="type-btn" onclick="setMode('quote')" id="btnQuote" style="flex:1; padding:15px; background:#1a1a1a; border:1px solid #333; color:#888; border-radius:12px; cursor:pointer; text-align:center; transition:0.3s;">
                <i class="fa-solid fa-file-invoice-dollar" style="display:block; font-size:1.4rem; margin-bottom:5px;"></i>
                <span>Ø·Ù„Ø¨ Ø³Ø¹Ø±</span>
            </div>
        </div>

        <form id="mainForm" enctype="multipart/form-data">
            
            <div style="margin-bottom:15px;">
                <label style="display:block; color:#bbb; margin-bottom:8px;">Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ / Ø§Ù„ØµÙ†Ù</label>
                <input type="text" name="job_name" class="p-input" required placeholder="Ù…Ø«Ø§Ù„: Ø·Ø¨Ø§Ø¹Ø© ÙƒØ±ÙˆØª Ø´Ø®ØµÙŠØ©" style="width:100%; padding:12px; background:#0a0a0a; border:1px solid #333; color:#fff; border-radius:8px;">
            </div>

            <div style="margin-bottom:15px;">
                <label style="display:block; color:#bbb; margin-bottom:8px;">Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø®ØªØµ</label>
                <select name="service_type" class="p-input" style="width:100%; padding:12px; background:#0a0a0a; border:1px solid #333; color:#fff; border-radius:8px;">
                    <option value="Ø·Ø¨Ø§Ø¹Ø© Ø¹Ø§Ù…Ø©">Ø·Ø¨Ø§Ø¹Ø© Ø£ÙˆÙØ³Øª/Ø¯ÙŠØ¬ÙŠØªØ§Ù„</option>
                    <option value="Ø¹Ù„Ø¨ ÙƒØ±ØªÙˆÙ†">Ø¹Ù„Ø¨ ÙƒØ±ØªÙˆÙ†</option>
                    <option value="Ø£ÙƒÙŠØ§Ø³ Ø¨Ù„Ø§Ø³ØªÙŠÙƒ">Ø£ÙƒÙŠØ§Ø³ Ø¨Ù„Ø§Ø³ØªÙŠÙƒ</option>
                    <option value="Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§">ØªØ³ÙˆÙŠÙ‚ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</option>
                    <option value="ØªØµÙ…ÙŠÙ…">ØªØµÙ…ÙŠÙ… ÙÙ‚Ø·</option>
                    <option value="Ù…ÙˆÙ‚Ø¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">Ù…ÙˆÙ‚Ø¹ / Ø¨Ø±Ù…Ø¬Ø©</option>
                </select>
            </div>

            <div style="margin-bottom:15px;">
                <label style="display:block; color:#bbb; margin-bottom:8px;">Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                <input type="number" name="quantity" class="p-input" placeholder="Ø§Ù„Ø¹Ø¯Ø¯" style="width:100%; padding:12px; background:#0a0a0a; border:1px solid #333; color:#fff; border-radius:8px;">
            </div>

            <div style="margin-bottom:15px;">
                <label style="display:block; color:#bbb; margin-bottom:8px;">Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ù…ÙˆØ§ØµÙØ§Øª</label>
                <textarea name="details" class="p-input" rows="5" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù‚Ø§Ø³Ø§ØªØŒ Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŒ ÙˆØ£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙÙ†ÙŠØ©..." style="width:100%; padding:12px; background:#0a0a0a; border:1px solid #333; color:#fff; border-radius:8px;"></textarea>
            </div>

            <div style="margin-bottom:15px;">
                <label style="display:block; color:#bbb; margin-bottom:8px;">Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª (ØªØµÙ…ÙŠÙ…/Ø´Ø¹Ø§Ø±/Ø¹ÙŠÙ†Ø©)</label>
                <input type="file" name="attachment[]" multiple style="width:100%; padding:10px; background:#0a0a0a; border:1px solid #333; color:#fff; border-radius:8px;">
            </div>

            <button type="submit" id="submitBtn" style="width:100%; padding:15px; background:linear-gradient(135deg, #d4af37, #b8860b); border:none; border-radius:10px; color:#000; font-weight:bold; font-size:1.1rem; cursor:pointer; margin-top:10px;">ğŸš€ ÙØªØ­ Ø£Ù…Ø± ØªØ´ØºÙŠÙ„</button>
        </form>
        
        <div id="msg" style="margin-top:15px; text-align:center; font-weight:bold; padding:10px; border-radius:8px; display:none;"></div>
    </div>

    <script src="js/layout.js"></script>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        let mode = urlParams.get('type') || 'order'; 

        setMode(mode);

        function setMode(m) {
            mode = m;
            document.querySelectorAll('.type-btn').forEach(b => {
                b.style.borderColor = '#333';
                b.style.color = '#888';
                b.style.background = '#1a1a1a';
            });
            const activeBtn = document.getElementById(m === 'order' ? 'btnOrder' : 'btnQuote');
            activeBtn.style.borderColor = '#d4af37';
            activeBtn.style.color = '#d4af37';
            activeBtn.style.background = 'rgba(212, 175, 55, 0.08)';
            
            const btnText = m === 'order' ? 'ğŸš€ ÙØªØ­ Ø£Ù…Ø± ØªØ´ØºÙŠÙ„' : 'ğŸ“„ Ø·Ù„Ø¨ Ø¹Ø±Ø¶ Ø³Ø¹Ø±';
            document.getElementById('submitBtn').innerText = btnText;
        }

        document.getElementById('mainForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            const msg = document.getElementById('msg');
            
            btn.disabled = true; 
            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
            msg.style.display = 'none';
            
            const formData = new FormData(this);
            const api = mode === 'order' ? 'api/create_order.php' : 'api/request_quote.php';

            try {
                const res = await fetch(api, { method: 'POST', body: formData });
                const data = await res.json();
                
                msg.style.display = 'block';
                
                if(data.status === 'success') {
                    msg.style.background = 'rgba(46, 204, 113, 0.15)';
                    msg.style.color = '#2ecc71';
                    msg.style.border = '1px solid #2ecc71';
                    msg.innerHTML = `âœ… ${data.message}`;
                    setTimeout(() => window.location.href = 'dashboard.html', 2000);
                } else {
                    throw new Error(data.message);
                }
            } catch(err) {
                msg.style.background = 'rgba(231, 76, 60, 0.15)';
                msg.style.color = '#e74c3c';
                msg.style.border = '1px solid #e74c3c';
                msg.innerHTML = `âŒ ${err.message}`;
                btn.disabled = false; 
                btn.innerText = (mode === 'order' ? 'ğŸš€ ÙØªØ­ Ø£Ù…Ø± ØªØ´ØºÙŠÙ„' : 'ğŸ“„ Ø·Ù„Ø¨ Ø¹Ø±Ø¶ Ø³Ø¹Ø±');
            }
        });
    </script>
</body>
</html>